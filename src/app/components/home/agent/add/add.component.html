<form [formGroup]="agentForm" (ngSubmit)="onSubmit()" class="px-[3%] py-3 md:py-5">
    <div class="bg-white w-full rounded-3xl  shadow p-[2%]">
      <div class="flex justify-between h-12">
        <h1 class="text-[--blue-text] text-lg font-bold">Create Agent</h1>
      </div>
      <div class="grid md:grid-cols-2 pb-5 gap-5 md:gap-10">
        <div class="w-full ">
          <div class="py-2">Name <span class="text-red-500">*</span></div>
          <input 
            formControlName="name" 
            class="bg-[--input] h-[50px] w-full rounded-lg p-2 outline-none focus:ring-1 focus:ring-[--primary]"
            [class.border-red-500]="agentForm.get('name')?.invalid && agentForm.get('name')?.touched"
            [class.border-2]="agentForm.get('name')?.invalid && agentForm.get('name')?.touched"
            type="text" 
            id="name"
            autofocus>
          <div *ngIf="agentForm.get('name')?.invalid && agentForm.get('name')?.touched" class="text-red-500 text-sm mt-1">
            <span *ngIf="agentForm.get('name')?.errors?.['required']">Name is required</span>
            <span *ngIf="agentForm.get('name')?.errors?.['minlength']">Name must be at least 2 characters</span>
          </div>
        </div>
        <div class="w-full ">
          <div class="py-2">Remarks</div>
          <input formControlName="remarks" class="bg-[--input] h-[50px] w-full rounded-lg p-2 outline-none focus:ring-1 focus:ring-[--primary]" type="text" id="remarks">
        </div>  
        <!-- newly added -->
        <div class="w-full ">
          <div class="py-2">Address <span class="text-red-500">*</span></div>
          <input 
            formControlName="address"
            class="bg-[--input] h-[50px] w-full rounded-lg p-2 outline-none focus:ring-1 focus:ring-[--primary]"
            [class.border-red-500]="agentForm.get('address')?.invalid && agentForm.get('address')?.touched"
            [class.border-2]="agentForm.get('address')?.invalid && agentForm.get('address')?.touched"
            type="text" 
            id="address">
          <div *ngIf="agentForm.get('address')?.invalid && agentForm.get('address')?.touched" class="text-red-500 text-sm mt-1">
            <span *ngIf="agentForm.get('address')?.errors?.['required']">Address is required</span>
            <span *ngIf="agentForm.get('address')?.errors?.['minlength']">Address must be at least 5 characters</span>
          </div>
        </div>
        <!-- div -->
        <div class="w-full ">
          <div class="py-2">Mobile Number <span class="text-red-500">*</span></div>
          <input 
            formControlName="mobileNumber"
            class="bg-[--input] h-[50px] w-full rounded-lg p-2 outline-none focus:ring-1 focus:ring-[--primary]"
            [class.border-red-500]="agentForm.get('mobileNumber')?.invalid && agentForm.get('mobileNumber')?.touched"
            [class.border-2]="agentForm.get('mobileNumber')?.invalid && agentForm.get('mobileNumber')?.touched"
            type="text" 
            id="mobileNumber">
          <div *ngIf="agentForm.get('mobileNumber')?.invalid && agentForm.get('mobileNumber')?.touched" class="text-red-500 text-sm mt-1">
            <span *ngIf="agentForm.get('mobileNumber')?.errors?.['required']">Mobile number is required</span>
            <span *ngIf="agentForm.get('mobileNumber')?.errors?.['pattern']">Please enter a valid 10-digit mobile number</span>
          </div>
        </div>
        <!-- div -->
        <div class="w-full  ">
          <div class="py-2">Pan No <span class="text-red-500">*</span></div>
          <div class="flex gap-2">
            <select 
              formControlName="selectedPAN"
              class="bg-[--input] h-[50px] w-full rounded-lg p-2 outline-none focus:ring-1 focus:ring-[--primary]"
              [class.border-red-500]="agentForm.get('selectedPAN')?.invalid && agentForm.get('selectedPAN')?.touched"
              [class.border-2]="agentForm.get('selectedPAN')?.invalid && agentForm.get('selectedPAN')?.touched"
              id="selectedPAN">
              <option value="">Select PAN</option>
              <option *ngFor="let data of pandata" [value]="data">{{data}}</option>
            </select>
            <button type="button" (click)="showpanmodal=true" class="bg-[--primary] hover:bg-black hover:text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:shadow-outline flex items-center h-[50px]">
              <span class="text-2xl mr-1">+</span> Add
            </button>
          </div>
          <div *ngIf="agentForm.get('selectedPAN')?.invalid && agentForm.get('selectedPAN')?.touched" class="text-red-500 text-sm mt-1">
            <span *ngIf="agentForm.get('selectedPAN')?.errors?.['required']">PAN is required</span>
            <span *ngIf="agentForm.get('selectedPAN')?.errors?.['pattern']">Please enter a valid PAN format</span>
          </div>
        </div>
        <!-- div -->
        <div class="w-full ">
          <div class="py-2">Brokage <span class="text-red-500">*</span></div>
          <select 
            formControlName="brokage" 
            class="bg-[--input] h-[50px] w-full rounded-lg p-2 outline-none focus:ring-1 focus:ring-[--primary]"
            [class.border-red-500]="agentForm.get('brokage')?.invalid && agentForm.get('brokage')?.touched"
            [class.border-2]="agentForm.get('brokage')?.invalid && agentForm.get('brokage')?.touched">
            <option value="">Select Brokage Type</option>
            <option [ngValue]="0">Taxable amount</option>
            <option [ngValue]="1">Bill amount</option>
          </select>
          <div *ngIf="agentForm.get('brokage')?.invalid && agentForm.get('brokage')?.touched" class="text-red-500 text-sm mt-1">
            <span *ngIf="agentForm.get('brokage')?.errors?.['required']">Brokage type is required</span>
          </div>
        </div>
        <!-- div -->
        <div class="w-full ">
          <div class="py-2">Brokage Percentage <span class="text-red-500">*</span></div>
          <input 
            formControlName="brokagePercentage"
            class="bg-[--input] h-[50px] w-full rounded-lg p-2 outline-none focus:ring-1 focus:ring-[--primary]"
            [class.border-red-500]="agentForm.get('brokagePercentage')?.invalid && agentForm.get('brokagePercentage')?.touched"
            [class.border-2]="agentForm.get('brokagePercentage')?.invalid && agentForm.get('brokagePercentage')?.touched"
            type="number" 
            id="brokagePercentage">
          <div *ngIf="agentForm.get('brokagePercentage')?.invalid && agentForm.get('brokagePercentage')?.touched" class="text-red-500 text-sm mt-1">
            <span *ngIf="agentForm.get('brokagePercentage')?.errors?.['required']">Brokage percentage is required</span>
            <span *ngIf="agentForm.get('brokagePercentage')?.errors?.['min']">Percentage must be at least 0</span>
            <span *ngIf="agentForm.get('brokagePercentage')?.errors?.['max']">Percentage cannot exceed 100</span>
          </div>
        </div>
      </div>
      <div class="flex justify-end gap-2">
        <button type="button" class="h-14 w-36 text-[--primary] border-[--primary] border hover:text-white hover:bg-black font-bold py-2 px-4 rounded-md focus:outline-none focus:shadow-outline" [routerLink]="['/agent']">
          Cancel
        </button>
        <button type="submit" class="h-14 w-36 bg-[--primary] hover:bg-black text-white font-bold py-2 px-4 rounded-md focus:outline-none focus:shadow-outline">
          Submit
        </button>
      </div>
    </div>
  </form>
<div *ngIf="showpanmodal" class="fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-30">
  <div class="bg-white w-[350px] max-w-full rounded-xl shadow-2xl p-0 overflow-hidden relative animate-fade-in">
    <button (click)="showpanmodal=false" type="button" class="absolute top-3 right-3 text-gray-400 hover:text-[--primary] transition-colors w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 shadow">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
    <div class="w-full bg-[--primary] p-4 text-white font-semibold text-lg rounded-t-xl flex items-center justify-between">
      <span>PAN Details</span>
    </div>
    <div class="p-4 space-y-4">
      <div class="flex gap-2">
        <input 
          [(ngModel)]="newPanValue" 
          type="text" 
          class="border px-3 py-2 rounded w-full focus:ring-2 focus:ring-[--primary] outline-none"
          placeholder="Enter PAN number">
        <button 
          (click)="addPanData()" 
          class="bg-[--primary] hover:bg-black text-white rounded px-4 py-2 font-semibold transition-colors">
          Add
        </button>
      </div>
      <div class="max-h-48 overflow-y-auto divide-y divide-gray-100 bg-gray-50 rounded-md p-2">
        <div *ngFor="let pan of pandata; let i = index" class="flex justify-between items-center py-2 px-1">
          <div class="font-mono text-gray-700">{{pan}}</div>
          <div class="flex gap-2">
            <button (click)="editPanData(i)" class="text-blue-600 hover:underline font-medium">Edit</button>
            <button (click)="deletePanData(i)" class="text-red-600 hover:underline font-medium">Delete</button>
          </div>
        </div>
        <div *ngIf="pandata.length === 0" class="text-center text-gray-400 py-4">
          No PAN data available
        </div>
      </div>
    </div>
  </div>
</div>